# volatile

**`volatile` 是 C++ 中的一个关键字，用于告知编译器一个变量的值可能会在程序的控制之外被改变。使用 `volatile` 关键字的变量表明它的值可能会随时改变，因此编译器在每次使用该变量时都必须重新从内存中读取其值，而不是使用寄存器中的值或缓存的值。**

### 用途

1. **内存共享变量**：在多线程环境中，当多个线程共享一个变量时，如果一个线程修改了这个变量，其他线程访问这个变量时必须使用 `volatile` 关键字，以确保它们读取的是最新的值。
2. **硬件寄存器访问**：在嵌入式编程中，`volatile` 通常用于访问硬件设备的寄存器，因为这些寄存器的值可能会因为硬件的行为而突然改变。
3. **中断服务程序**：在中断服务程序中，用于控制硬件的变量应该被声明为 `volatile`，以确保程序在中断和非中断代码之间正确同步。

### 限制

- `volatile` 只影响编译器如何访问变量，它不提供任何同步机制。在多线程环境中，仅仅使用 `volatile` 是不足以保证操作的原子性或线程安全的。
- `volatile` 不能用于非整型变量，例如，你不能将 `volatile` 应用于 `double` 或 `float` 类型的变量。
- `volatile` 不能阻止编译器优化程序，它只能防止编译器对 `volatile` 变量的某些优化。



volatile 关键字声明的变量，每次访问时都必须从内存中取出值（没有被 volatile 修饰的变量，可能由于编译器的优化，从 CPU 寄存器中取值）